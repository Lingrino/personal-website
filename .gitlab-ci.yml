image: python:3-alpine

stages:
  - publish

publish:
  stage: publish
  only:
    refs:
      - master
  script:
    - pip install awscli
    - aws --region "${S3_REGION}"" s3 sync . "s3://${S3_BUCKET_NAME}"
    - aws cloudfront create-invalidation --distribution-id "${CF_DISTRIBUTION_ID}" --paths "/*"
